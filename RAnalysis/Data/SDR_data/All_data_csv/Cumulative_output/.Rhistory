geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,3], main= "Ref vs. alpha0.2_min10.20")#Adjusted R-squared:  0.2892
summary(lm(TRIAL1[,1]~TRIAL1[,3]))
plot(TRIAL1[,1],TRIAL1[,4], main= "Ref vs. alpha0.2_min10.25")#Adjusted R-squared:  0.1674
summary(lm(TRIAL1[,1]~TRIAL1[,4]))
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,4])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.3905
summary(lm(TRIAL1[,1]~TRIAL1[,5]))
library(ggplot2)
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,5])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
# outside of loess curve are 57,52,3,2,1,76,50,96,31,5,29,17,70,72,68,56,94,
shapiro.test(TRIAL1[,5]) # not normal
plot(TRIAL1[,1],TRIAL1[,6], main= "Ref vs. alpha0.4_min10.20")#Adjusted R-squared:  0.2589
plot(TRIAL1[,1],TRIAL1[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.3905
summary(lm(TRIAL1[,1]~TRIAL1[,5]))
library(ggplot2)
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,5])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
rm(list=ls())
setwd("C:/Users/samjg/Documents/Notebook/data/Geoduck_Conditioning/RAnalysis/Data/SDR_data")
main<-getwd()
#CHANGE THESE VALUES EVERY DAY----------------------------------------------------------------------
path<-"All_data_csv" #the location of all your titration files
respfile<-"20180724_resp_Day10_RUN1_Oxygen.csv" # name of your file with resp data
#load Data------------------------------------------------------------------------------------------
resp<-read.csv(file.path(path,respfile), header=T, sep=",", na.string="NA", as.is=T)
# take a look at the file
resp
library(LoLinR)
# assign headers----------------------------------------------------------------------------------
resp.data <- resp[,c(1:26)] #select columns = 26 total (Date + Time + 24 vials on SDR plate)
#SDR plate organization - name columns accordingly as TANK_vial (Ex: H1_T_B1 where H1_T = Tank name; B1 = vial position)
############################-------------------------------------------------------------------------
######   H0 & H1   #########
colnames(resp.data) <- c("Date", "minutes",
#Row 1 (A1, B1, C1, D1)
"H0_T_A1", "H0_B_B1", "H0_T_blank_C1", "H0_B_blank_D1",
#Row 2 (A2, B2, C2, D2)
"H0_T_A2","H0_B_B2", "H0_T_blank_C2", "H0_B_blank_D2",
#Row 3 (A3, B3, C3, D3)
"H0_T_A3", "H0_B_B3", "H0_T_blank_C3", "H0_B_blank_D3",
#Row 4 (A4, B4, C4, D4)
"H1_T_A4", "H1_B_B4", "H1_T_blank_C4", "H1_B_blank_D4",
#Row 5 (A5, B5, C5, D5)
"H1_T_A5", "H1_B_B5", "H1_T_blank_C5", "H1_B_blank_D5",
#Row 6 (A6, B6, C6, D6)
"H1_T_A6", "H1_B_B6", "H1_T_blank_C6", "H1_B_blank_D6") #rename columns
# fill this in and press Cnrt A + enter for each vial
Date <- "20180724"
tank_name <- "H0_B"
vial_pos <- "B1"
ID <- "H0_B_B1"
tank_vial <- resp.data$H1_B_B6
alpha <- 0.5
# make a model for one of your data sets---------------------------------------
model<-rankLocReg(
xall=resp.data$minutes,yall=tank_vial,
alpha=0.2, method="pc", verbose=TRUE)
#plot the model----------------------------------------------------------------
plot(model, rank=1)
#plot the model----------------------------------------------------------------
plot(model, rank=1)
###################################################################################################
rm(list=ls())
library(dplyr)
library(plyr)
library(ggplot2)
library(ggpubr)
library(Rmisc)
#set working directory--------------------------------------------------------------------------------------------------
setwd("C:/Users/samjg/Documents/Notebook/data/Geoduck_Conditioning/RAnalysis/Data/SDR_data/All_data_csv/Cumulative_output/")
main<-getwd()
# path used in the loop to each file name indicated in Table_files (matrix of filenames created below)
path<-"Summary" #the locationv of all your respiration files
########################
# make the dataframe
########################
dat<-read.csv(file.path(path, ("All_resp_calc_and_standardized.csv")), header=T, sep=",", na.string="NA", as.is=T)
########################
# seperate into trial 1 and trial 2
########################
# Trial 1
data <-dat
# add a column for row names to identify scatterplot rows
data[,17] <- tibble::rownames_to_column(data, "ROWS")
# Trial 1
TRIAL1 <-dat[1:96,]
tail(TRIAL1, 34)
names(TRIAL1)
# add a column for row names to identify scatterplot rows
TRIAL1[,17] <- tibble::rownames_to_column(TRIAL1, "ROWS")
# Trial 2
TRIAL2 <-dat[97:192,]
tail(TRIAL2, 34)
nrow(TRIAL2)
# add a column for row names to identify scatterplot rows
TRIAL2[,17] <- tibble::rownames_to_column(TRIAL2, "ROWS")
########################
# plotted all automated ouputs ([,2-10]) to the output by hand ([,1])
########################
par(mfrow=c(1,1))
plot(data[,1],data[,2], main= "Ref vs. alpha0.2_all")#Adjusted R-squared:  0.4987
summary(lm(data[,1]~data[,2]))
text(data[,1],data[,2], labels=data$ROWS, cex= 0.7, offset=1)
abline(lm(data[,1]~data[,2]))
ggplot(data, aes(data[,1],data[,2])) +
geom_point() +
geom_text(aes(label = data$ROWS), position = position_nudge(y = -0.01))
ggplot(data, aes(x = data[,1], y = data[,2])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = data$ROWS), position = position_nudge(y = -0.01))
plot(data[,1],data[,4], main= "Ref vs. alpha0.2_min10.25")#Adjusted R-squared:  0.1674
summary(lm(data[,1]~data[,4]))
plot(data[,1],data[,3], main= "Ref vs. alpha0.2_min10.20")#Adjusted R-squared:  0.2892
plot(data[,1],data[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.3905
summary(lm(data[,1]~data[,3]))
library(ggplot2)
ggplot(data, aes(x = data[,1], y = data[,4])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = data$ROWS), position = position_nudge(y = -0.01))
summary(lm(data[,1]~data[,5]))
ggplot(data, aes(x = data[,1], y = data[,5])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = data$ROWS), position = position_nudge( y = -0.01))
plot(data[,1],data[,6], main= "Ref vs. alpha0.4_min10.20")#Adjusted R-squared:  0.2589
summary(lm(data[,1]~data[,6]))
ggplot(data, aes(x = data[,1], y = data[,6])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = data$ROWS), position = position_nudge(y = -0.01))
summary(lm(data[,1]~data[,7]))
ggplot(data, aes(x = data[,1], y = data[,7])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = data$ROWS), position = position_nudge(y = -0.01))
plot(data[,1],data[,8], main= "Ref vs. alpha0.6_all")#Adjusted R-squared:  0.4947
summary(lm(data[,1]~data[,8]))
plot(data[,1],data[,7], main= "Ref vs. alpha0.4_min10.25")#Adjusted R-squared:  0.315
ggplot(data, aes(x = data[,1], y = data[,8])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = data$ROWS), position = position_nudge(y = -0.01))
plot(data[,1],data[,9], main= "Ref vs. alpha0.6_min10.20")#Adjusted R-squared:  0.4037
summary(lm(data[,1]~data[,9]))
plot(data[,1],data[,10], main= "Ref vs. alpha0.6_min10.25")#Adjusted R-squared:  0.4409
summary(lm(data[,1]~data[,10]))
plot(TRIAL1[,1],TRIAL1[,2], main= "Ref vs. alpha0.2_all")#Adjusted R-squared:  0.4987
summary(lm(TRIAL1[,1]~TRIAL1[,2]))
text(TRIAL1[,1],TRIAL1[,2], labels=TRIAL1$ROWS, cex= 0.7, offset=1)
abline(lm(TRIAL1[,1]~TRIAL1[,2]))
ggplot(TRIAL1, aes(TRIAL1[,1],TRIAL1[,2])) +
geom_point() +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
abline(lm(TRIAL1[,1]~TRIAL1[,2]))
ggplot(TRIAL1, aes(TRIAL1[,1],TRIAL1[,2])) +
geom_point() +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,2])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,3], main= "Ref vs. alpha0.2_min10.20")#Adjusted R-squared:  0.2892
summary(lm(TRIAL1[,1]~TRIAL1[,3]))
plot(TRIAL1[,1],TRIAL1[,4], main= "Ref vs. alpha0.2_min10.25")#Adjusted R-squared:  0.1674
summary(lm(TRIAL1[,1]~TRIAL1[,4]))
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,4])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.3905
summary(lm(TRIAL1[,1]~TRIAL1[,5]))
library(ggplot2)
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,5])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,2], main= "Ref vs. alpha0.2_all")#Adjusted R-squared:  0.4987
summary(lm(TRIAL1[,1]~TRIAL1[,2]))
text(TRIAL1[,1],TRIAL1[,2], labels=TRIAL1$ROWS, cex= 0.7, offset=1)
abline(lm(TRIAL1[,1]~TRIAL1[,2]))
ggplot(TRIAL1, aes(TRIAL1[,1],TRIAL1[,2])) +
geom_point() +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,2])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,3], main= "Ref vs. alpha0.2_min10.20")#Adjusted R-squared:  0.2892
summary(lm(TRIAL1[,1]~TRIAL1[,3]))
plot(TRIAL1[,1],TRIAL1[,4], main= "Ref vs. alpha0.2_min10.25")#Adjusted R-squared:  0.1674
summary(lm(TRIAL1[,1]~TRIAL1[,4]))
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,4])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.3905
summary(lm(TRIAL1[,1]~TRIAL1[,5]))
library(ggplot2)
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,5])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
summary(lm(TRIAL1[,1]~TRIAL1[,2]))
text(TRIAL1[,1],TRIAL1[,2], labels=TRIAL1$ROWS, cex= 0.7, offset=1)
abline(lm(TRIAL1[,1]~TRIAL1[,2]))
plot(TRIAL1[,1],TRIAL1[,2], main= "Ref vs. alpha0.2_all")#Adjusted R-squared:  0.4987
summary(lm(TRIAL1[,1]~TRIAL1[,2]))
text(TRIAL1[,1],TRIAL1[,2], labels=TRIAL1$ROWS, cex= 0.7, offset=1)
abline(lm(TRIAL1[,1]~TRIAL1[,2]))
[
plot(TRIAL1[,1],TRIAL1[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.4987
summary(lm(TRIAL1[,1]~TRIAL1[,5]))
text(TRIAL1[,1],TRIAL1[,5], labels=TRIAL1$ROWS, cex= 0.7, offset=1)
abline(lm(TRIAL1[,1]~TRIAL1[,5]))
plot(TRIAL1[,1],TRIAL1[,6], main= "Ref vs. alpha0.4_min10.20")#Adjusted R-squared:  0.2589
summary(lm(TRIAL1[,1]~TRIAL1[,6]))
plot(TRIAL1[,1],TRIAL1[,7], main= "Ref vs. alpha0.4_min10.25")#Adjusted R-squared:  0.315
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,6])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
summary(lm(TRIAL1[,1]~TRIAL1[,7]))
summary(lm(TRIAL1[,1]~TRIAL1[,8]))
plot(TRIAL1[,1],TRIAL1[,8], main= "Ref vs. alpha0.6_all")#Adjusted R-squared:  0.4947
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,7])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,9], main= "Ref vs. alpha0.6_min10.20")#Adjusted R-squared:  0.4037
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,8])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL1[,1],TRIAL1[,10], main= "Ref vs. alpha0.6_min10.25")#Adjusted R-squared:  0.4409
summary(lm(TRIAL1[,1]~TRIAL1[,9]))
summary(lm(TRIAL1[,1]~TRIAL1[,10]))
# alpha 0.2 and all has the closest relationship to the measurements by hand (0.4987)
############
# (1) look for ouliers in the data
##############
# -----Reference
OutVals = boxplot(TRIAL1[,1])$out
# 17 and 29 are ouliers from TRIAL1 by hand reference ouput
# -----alpha = 0.2 all
OutVals = boxplot(TRIAL1[,2])$out
which(TRIAL1[,2] %in% OutVals)
which(TRIAL1[,5] %in% OutVals)
which(TRIAL1[,1] %in% OutVals)
#make a new dataset based on the number of points ouside of loess curve for alpha =0.4_all
# 19 total numbers are 57,52,3,6,17,2,1,76,50,96,31,5,29,70,72,68,56,94
newdata_TRIAL1_ALL <- data.frame(TRIAL1$Date, TRIAL1[,c(1:10)])
# rows 17 and 57 are ouliers in alpha = 0.4 all
OutVals = boxplot(TRIAL1[,5])$out
newdata_TRIAL1_ALL_1 <-newdata_TRIAL1_ALL[c(57,52,3,6,17,2,1,76,50,96,31,5,29,70,72,68,56,94), ]
newdata_TRIAL1_ALL_om <- newdata_TRIAL1_ALL[c(52,3,6,2,1,76,50,96,31,5,70,72,68,56,94), ] #17 29 and 57 omitted
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,3])
summary(lm(newdata_TRIAL1_ALL_1[,3]~newdata_TRIAL1_ALL_1[,2]))#Adjusted R-squared: 0.5145
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,4])
summary(lm(newdata_TRIAL1_ALL_1[,4]~newdata_TRIAL1_ALL_1[,2]))#Adjusted R-squared:  0.6196
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,5])
summary(lm(newdata_TRIAL1_ALL_1[,5]~newdata_TRIAL1_ALL_1[,2]))#  0.07991
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,6])
summary(lm(newdata_TRIAL1_ALL_1[,6]~newdata_TRIAL1_ALL_1[,2]))# 0.0618
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,7])
summary(lm(newdata_TRIAL1_ALL_1[,7]~newdata_TRIAL1_ALL_1[,2]))#0.3223
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,8])
summary(lm(newdata_TRIAL1_ALL_1[,8]~newdata_TRIAL1_ALL_1[,2]))#0.205
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,9])
summary(lm(newdata_TRIAL1_ALL_1[,9]~newdata_TRIAL1_ALL_1[,2]))#0.2356
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,10]) # alpha = 0.6 10-20 min
summary(lm(newdata_TRIAL1_ALL_1[,10]~newdata_TRIAL1_ALL_1[,2]))# 0.7235
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,11])
summary(lm(newdata_TRIAL1_ALL_1[,11]~newdata_TRIAL1_ALL_1[,2]))#  0.3334
plot(newdata_TRIAL1_ALL_1[,2],newdata_TRIAL1_ALL_1[,10]) # alpha = 0.6 10-20 min
summary(lm(newdata_TRIAL1_ALL_1[,10]~newdata_TRIAL1_ALL_1[,2]))# 0.7235
# TRIAL1[,5] =  alpha 0.4_all
# TRIAL1[,9] = alpha 0.6_10-20mins
#assgin new  "FINAL" column base as the alpha 0.4 all
TRIAL1$FINALresp <- TRIAL1[,5]
TRIAL1[c(57,52,3,6,17,2,1,76,50,96,31,5,29,70,72,68,56,94),18] <- TRIAL1[c(57,52,3,6,17,2,1,76,50,96,31,5,29,70,72,68,56,94), 9]
# normality test
shapiro.test(TRIAL1[,18]) # not normal
hist(TRIAL1[,18]) # positive or right skewed - need to transform the data
# normality test
shapiro.test(TRIAL1[,18]) # not normal
hist(TRIAL1[,18]) # positive or right skewed - need to transform the data
# transform via squareroot gets a normal distrubtion via shapro wilk test
TRIAL1$sqrt_FINALresp <- sqrt(TRIAL1[,18])
shapiro.test(TRIAL1[,19]) # not normal
hist(TRIAL1[,19])
# normality test
shapiro.test(TRIAL1[,18]) # not normal
hist(TRIAL1[,18]) # positive or right skewed - need to transform the data
# transform via squareroot gets a normal distrubtion via shapro wilk test
TRIAL1$sqrt_FINALresp <- sqrt(TRIAL1[,18])
shapiro.test(TRIAL1[,19]) # not normal
hist(TRIAL1[,19])
# regress the new data column FINALresp with the column of resp by hand ("REF") TRIAL1[,1]
# lets look at a plot of our raw untransformed FINALresp data TABLE1[,18]
plot(TRIAL1[,1],TRIAL1[,18], main= "Ref vs. FINALresp")
summary(lm(TRIAL1[,1]~TRIAL1[,18])) # Multiple R-squared:  0.8784,	Adjusted R-squared:  0.8771
library(ggplot2)
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,18])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
# regress the new data column FINALresp with the column of resp by hand ("REF") TRIAL1[,1]
# lets look at a plot of our raw untransformed FINALresp data TABLE1[,18]
plot(TRIAL1[,1],TRIAL1[,18], main= "Ref vs. FINALresp")
summary(lm(TRIAL1[,1]~TRIAL1[,18])) # Multiple R-squared:  0.8784,	Adjusted R-squared:  0.8771
library(ggplot2)
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,18])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
# regress the new data column FINALresp with the column of resp by hand ("REF") TRIAL1[,1]
# lets look at a plot of our raw untransformed FINALresp data TABLE1[,18]
plot(TRIAL1[,1],TRIAL1[,18], main= "Ref vs. FINALresp")
summary(lm(TRIAL1[,1]~TRIAL1[,18])) # Multiple R-squared:  0.8784,	Adjusted R-squared:  0.8771
ggplot(TRIAL1, aes(x = TRIAL1[,1], y = TRIAL1[,18])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL1$ROWS), position = position_nudge(y = -0.01))
# get a table of means and deviations
sumTRIAL1 <- summarySE(TRIAL1,
measurevar="FINALresp",
groupvars=c("Date","Treat1_Treat2"))
sumTRIAL1
# get percent difference
sumTRIAL1_means <- summarySE(sumTRIAL1,
measurevar="FINALresp",
groupvars=c("Treat1_Treat2"))
sumTRIAL1_means
percentdiff <- ((sumTRIAL1_means[1,3] - sumTRIAL1_means[2,3])/sumTRIAL1_means[1,3])*100
percentdiff
# --------------------------treatment as a fixed effect and time as a random effect
resp.aov_trial1 <- aov(TRIAL1$sqrt_FINALresp ~
TRIAL1$Treat1_Treat2+
TRIAL1$Date, data = TRIAL1)
summary(resp.aov_trial1) # significant effect of treatment
# in reference to the individually completely TRIAL2aset
plot(TRIAL2[,1],TRIAL2[,2], main= "Ref vs. alpha0.2_all") #Adjusted R-squared:  0.4402
summary(lm(TRIAL2[,1]~TRIAL2[,2]))
text(TRIAL2[,1],TRIAL2[,2], labels=TRIAL1$ROWS, cex= 0.7, offset=1)
ggplot(TRIAL1, aes(TRIAL2[,1],TRIAL2[,2])) +
geom_point() +
geom_text(aes(label = TRIAL2$ROWS), position = position_nudge(y = -0.01))
# appears that rows 114,146,155,186,109,123,182 have greatest residuals or are outiers
ggplot(TRIAL2, aes(x = TRIAL2[,1], y = TRIAL2[,2])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL2$ROWS), position = position_nudge(y = -0.01))
plot(TRIAL2[,1],TRIAL2[,3], main= "Ref vs. alpha0.2_min10.20") #Adjusted R-squared:  0.4612
summary(lm(TRIAL2[,1]~TRIAL2[,3]))
plot(TRIAL2[,1],TRIAL2[,4], main= "Ref vs. alpha0.2_min10.25")#Adjusted R-squared:  0.5053
summary(lm(TRIAL2[,1]~TRIAL2[,4]))
plot(TRIAL2[,1],TRIAL2[,5], main= "Ref vs. alpha0.4_all")#Adjusted R-squared:  0.8002
summary(lm(TRIAL2[,1]~TRIAL2[,5]))
ggplot(TRIAL2, aes(x = TRIAL2[,1], y = TRIAL2[,5])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL2$ROWS), position = position_nudge(y = .01))
# numbers outside of loess curve are 114, 153,155,156,150,141,105,130,152,98,188 (take out 186)
numberrows <- (c(114,153,155,156,150,141,105,130,152,98,188)) - 96
# numbers outside of loess curve are 114, 153,155,156,150,141,105,130,152,98,188 (take out 186)
numberrows <- (c(114,153,155,156,150,141,105,130,152,98,188)) - 96
# actuall number of rows are 18 57 59 60 54 45  9 34 56  2 92
#check values
TRIAL2[c(18, 57, 59, 60 ,54 ,45 , 9 ,34 ,56,  2, 92), 5]
plot(TRIAL2[,1],TRIAL2[,6], main= "Ref vs. alpha0.4_min10.20")#Adjusted R-squared:  0.5743
summary(lm(TRIAL2[,1]~TRIAL2[,6]))
plot(TRIAL2[,1],TRIAL2[,7], main= "Ref vs. alpha0.4_min10.25")#Adjusted R-squared:  0.4952
summary(lm(TRIAL2[,1]~TRIAL2[,7]))
plot(TRIAL2[,1],TRIAL2[,8], main= "Ref vs. alpha0.6_all")#Adjusted R-squared:  0.4371
summary(lm(TRIAL2[,1]~TRIAL2[,8]))
plot(TRIAL2[,1],TRIAL2[,9], main= "Ref vs. alpha0.6_min10.20")#Adjusted R-squared:  0.6022
summary(lm(TRIAL2[,1]~TRIAL2[,9]))
plot(TRIAL2[,1],TRIAL2[,10], main= "Ref vs. alpha0.6_min10.25")#Adjusted R-squared:  0.5896
summary(lm(TRIAL2[,1]~TRIAL2[,10]))
# make a new data frame of just the REF ouput and alpha =0.2 all
newdata_TRIAL2_ALL <- data.frame(TRIAL2$Date , TRIAL2[,c(1:10)])
# test for correlative strength in dataset of JUST rows with weak residuals
newdata_TRIAL2_ALL_1 <-newdata_TRIAL2_ALL[c(18, 57, 59, 60 ,54 ,45 , 9 ,34 ,56,  2, 92), ]
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,3])
summary(lm(newdata_TRIAL2_ALL_1[,3]~newdata_TRIAL2_ALL_1[,2]))#Adjusted R-squared: 0.4139
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,4])
summary(lm(newdata_TRIAL2_ALL_1[,4]~newdata_TRIAL2_ALL_1[,2]))#Adjusted R-squared:  0.5674
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,5])
summary(lm(newdata_TRIAL2_ALL_1[,5]~newdata_TRIAL2_ALL_1[,2]))#  0.425
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,6])
summary(lm(newdata_TRIAL2_ALL_1[,6]~newdata_TRIAL2_ALL_1[,2]))# -0.02776
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,7])
summary(lm(newdata_TRIAL2_ALL_1[,7]~newdata_TRIAL2_ALL_1[,2]))#0.5682
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,8])
summary(lm(newdata_TRIAL2_ALL_1[,8]~newdata_TRIAL2_ALL_1[,2]))#00.4892
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,9])
summary(lm(newdata_TRIAL2_ALL_1[,9]~newdata_TRIAL2_ALL_1[,2]))#-0.4071
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,10])
summary(lm(newdata_TRIAL2_ALL_1[,10]~newdata_TRIAL2_ALL_1[,2]))#0.5931
plot(newdata_TRIAL2_ALL_1[,2],newdata_TRIAL2_ALL_1[,11]) # alpha = 0.6 10 - 25 mins
summary(lm(newdata_TRIAL2_ALL_1[,11]~newdata_TRIAL2_ALL_1[,2]))# 0.71699  !!!! use this!
#assgin new  "FINAL" column base as the alpha 0.4 all
# TRIAL2[,5] =0.4 all
TRIAL2$FINALresp <- TRIAL2[,5]
# FINAresp is TRIAL2[,18]
# insert the rows to replace with 0.6 10-25mins
TRIAL2[c(18, 57, 59, 60 ,54 ,45 , 9 ,34 ,56,  2, 92),18] <- TRIAL2[c(18, 57, 59, 60 ,54 ,45 , 9 ,34 ,56,  2, 92), 10]
# normality test
shapiro.test(TRIAL2[,18]) # not normal - ommit the data from row 186
hist(TRIAL2[,18]) # positive or right skewed - need to transform the data
# normality test
shapiro.test(TRIAL2[,18]) # not normal - ommit the data from row 186
hist(TRIAL2[,18]) # positive or right skewed - need to transform the data
#assgin new  "FINAL" column base as the alpha 0.4 all
# TRIAL2[,5] =0.4 all
TRIAL2$FINALresp <- TRIAL2[,5]
# FINAresp is TRIAL2[,18]
# insert the rows to replace with 0.6 10-25mins
TRIAL2[c(18, 57, 59, 60 ,54 ,45 , 9 ,34 ,56,  2, 92),18] <- TRIAL2[c(18, 57, 59, 60 ,54 ,45 , 9 ,34 ,56,  2, 92), 10]
# normality test
shapiro.test(TRIAL2[,18]) # not normal - ommit the data from row 186
hist(TRIAL2[,18]) # positive or right skewed - need to transform the data
OutVals2 = boxplot(TRIAL2[,18])$out
which(TRIAL2[,18] %in% OutVals2) # 83 and 90 are outliers
TRIAL2_om <- TRIAL2[-c(83,90),]
shapiro.test(TRIAL2_om[,18]) # normally distributed
hist(TRIAL2_om[,18])
TRIAL2_om <- TRIAL2[-c(83,90),]
shapiro.test(TRIAL2_om[,18]) # normally distributed
hist(TRIAL2_om[,18])
# regress the new data column FINALresp with the column of resp by hand ("REF") TRIAL1[,1]
# lets look at a plot of our raw untransformed FINALresp data TABLE1[,18]
plot(TRIAL2_om[,1],TRIAL2_om[,18], main= "Ref vs. FINALresp")
summary(lm(TRIAL2_om[,1]~TRIAL2_om[,18])) # Multiple R-squared:  0.9107,	Adjusted R-squared:  0.9097
library(ggplot2)
# regress the new data column FINALresp with the column of resp by hand ("REF") TRIAL1[,1]
# lets look at a plot of our raw untransformed FINALresp data TABLE1[,18]
plot(TRIAL2_om[,1],TRIAL2_om[,18], main= "Ref vs. FINALresp")
library(ggplot2)
ggplot(TRIAL2_om, aes(x = TRIAL2_om[,1], y = TRIAL2_om[,18])) +
geom_point() +
geom_smooth(method = 'loess') +
geom_text(aes(label = TRIAL2_om$ROWS), position = position_nudge(y = -0.01))
# get a table of means and deviations
names(TRIAL2_om)
sumTRIAL2 <- summarySE(TRIAL2_om,
measurevar="FINALresp",
groupvars=c("Date","Treat1_Treat2"))
summary(lm(TRIAL2_om[,1]~TRIAL2_om[,18])) # Multiple R-squared:  0.9107,	Adjusted R-squared:  0.9097
sumTRIAL2 # view the table
# get percent difference
sumTRIAL2_means <- summarySE(sumTRIAL2,
measurevar="FINALresp",
groupvars=c("Treat1_Treat2"))
sumTRIAL2_means
# --------------------------treatment as a fixed effect and time as a random effect
resp.aov_TRIAL2 <- aov(FINALresp ~
Treat1_Treat2 +
Date, data = TRIAL2_om)
summary(resp.aov_TRIAL2) # significant effect of treatment
"""Df Sum Sq Mean Sq F value Pr(>F)
Treat1_Treat2  3 0.1020 0.03399   3.852 0.0121 *
Date           1 0.0059 0.00591   0.669 0.4154
Residuals     89 0.7854 0.00882"""
# --------------------------treatment as a fixed effect and time as a random effect
resp.aov_TRIAL2 <- aov(FINALresp ~
Treat1_Treat2 +
Date, data = TRIAL2_om)
summary(resp.aov_TRIAL2) # significant effect of treatment
"""Df Sum Sq Mean Sq F value Pr(>F)
Treat1_Treat2  3 0.1020 0.03399   3.852 0.0121 *
Date           1 0.0059 0.00591   0.669 0.4154
Residuals     89 0.7854 0.00882"""
# ---------------------------treatment as a fixed effect and time as a fixed effect
resp.aov_TRIAL2_2 <- aov(FINALresp ~
Treat1_Treat2*Date, data = TRIAL2_om)
summary(resp.aov_TRIAL2_2) # significant effect of treatment
"""  Df Sum Sq Mean Sq F value Pr(>F)
Treat1_Treat2  3 0.1020 0.03399   3.852 0.0121 *
Date           1 0.0059 0.00591   0.669 0.4154
Residuals     89 0.7854 0.00882
---
"""
# ---------------------------treatment as a fixed effect and time as a fixed effect, tank as a random effect
resp.aov_TRIAL2_3 <- aov(FINALresp ~
Treat1_Treat2 *
Date +
tank, data = TRIAL2_om)
summary(resp.aov_TRIAL2_3) # significant effect of treatment and time
"""  Df Sum Sq Mean Sq F value   Pr(>F)
Treat1_Treat2  3 0.1020 0.03399   5.040  0.00291 **
Date           1 0.0059 0.00591   0.876  0.35196
tank           4 0.2121 0.05303   7.862 1.93e-05 ***
Residuals     85 0.5733 0.00674
--- """
modelTRIAL2 <- aov(FINALresp ~
Treat1_Treat2, data = TRIAL2_om)
summary(modelTRIAL2)
TukeyHSD(modelTRIAL2)
